# 프로젝트 세션 엔드포인트 관리

**참조 문서**: 이 파일은 세션 종료/시작 시 에이전트 팀이 프로젝트 상태를 정리하고 복원하는 가이드를 제공합니다.

## 🎯 목적

세션 종료 시 에이전트 팀이 각자 영역을 정리하고, 새 세션 시작 시 맥락을 복원하여 작업 연속성 보장

---

## 📋 Cursor AI 세션 특성

### 유지되는 것 ✅
- `.cursorrules`, `.cursor/rules/` 파일 (프로젝트 룰스)
- `!AGENT_System/` 폴더의 모든 로그/보고서
- 프로젝트 소스 파일, Git 히스토리

### 손실되는 것 ❌
- 현재 대화 컨텍스트 (이전 대화 내용)
- 임시 메모리 (대화 중 파악한 맥락)
- 진행 중이던 작업의 상태/맥락

---

## 📋 에이전트 팀 계층 구조

### 상급 팀 (유저룰스 - 항상 활성화)

| 팀 | 역할 | 핸드오프 담당 |
|----|------|-------------|
| **총괄 팀 (Chief)** | 전체 조율 및 핸드오프 문서 생성 | 전체 요약, 최종 문서 생성 |
| **PM 팀** | 진행 상황 및 일정 관리 | 진행률, TODO, 마일스톤 |
| **관리자 팀 (Admin)** | 효율성 및 전략 분석 | 효율성 지표, 전략적 이슈 |
| **감사 팀 (Audit)** | 품질 및 표준 준수 | 품질 이슈, 미해결 문제 |

### 프로젝트 팀 (프로젝트 룰스 - 프로젝트별 활성화)

**위치**: `.cursor/rules/AGENT_Teams.mdc`
**역할**: 프로젝트 성격에 맞는 전문가 팀 (Frontend, Backend, Data, Testing, Red Team 등)
**핸드오프 담당**: 각 팀이 자기 영역의 진행 상황, 이슈, TODO 정리

---

## 📋 세션 종료 커맨드 (session_handoff)

### 유저커맨드 헤더

```bash
# @command: session_handoff
# @purpose: 세션 종료 전 에이전트 팀별 정리 및 핸드오프 문서 생성
# @usage: 세션 종료 전, "끝내자", "마무리", "오늘은 여기까지" 요청 시
# @keywords: 핸드오프,인수인계,세션종료,handoff,끝,마무리,종료,여기까지,끝내기
# @triggers: "끝내자", "마무리", "오늘은 여기까지", "세션 종료", "핸드오프", "여기서 끝"
# @background: false
# @dependencies: common, sync_time, agent_teams
# @output: !AGENT_System/YYYYMMDD_HHMMSS_HANDOFF.MD 생성
```

### 실행 프로세스

```
세션 종료 트리거 감지:
  │
  ├─▶ 1. 시간 동기화
  │     └─ sync_time 실행
  │
  ├─▶ 2. 프로젝트 팀 정리 호출 (있는 경우)
  │     └─ `.cursor/rules/AGENT_Teams.mdc` 확인
  │     └─ 각 프로젝트 팀이 자기 영역 정리:
  │         ├─ Frontend Team → UI/컴포넌트 상태
  │         ├─ Backend Team → API/서버 상태
  │         ├─ Data Team → 데이터 파이프라인 상태
  │         ├─ Testing Team → 테스트 커버리지/이슈
  │         └─ Red Team → 보안 이슈
  │
  ├─▶ 3. 상급 팀 정리 호출
  │     ├─ PM 팀: 진행률, TODO, 마일스톤 정리
  │     ├─ 관리자 팀: 효율성 지표, 전략적 이슈 정리
  │     └─ 감사 팀: 품질 이슈, 미해결 문제 정리
  │
  ├─▶ 4. 총괄 팀 종합
  │     └─ 모든 팀의 정리 내용 종합
  │     └─ 핸드오프 문서 생성
  │
  └─▶ 5. 핸드오프 문서 저장
        └─ !AGENT_System/YYYYMMDD_HHMMSS_HANDOFF.MD
```

### 핸드오프 문서 템플릿

```markdown
---
title: "세션 핸드오프"
type: "handoff"
created: "YYYY-MM-DD HH:MM:SS"
session_end: "YYYY-MM-DD HH:MM:SS"
next_session_priority: "high/medium/low"
---

# 🔄 세션 핸드오프

**세션 종료**: YYYY-MM-DD HH:MM:SS
**다음 세션 우선순위**: [high/medium/low]

---

## 📋 총괄 요약 (Chief Team)

### 세션 요약
- [이번 세션에서 수행한 주요 작업]

### 핵심 성과
- [달성한 마일스톤/완료된 작업]

### 다음 세션 최우선 작업
- [가장 먼저 해야 할 일]

---

## 📊 진행 상황 (PM Team)

### 진행률
- 전체: [X%]
- 현재 단계: [단계명]

### 완료된 작업
- [완료 항목 목록]

### TODO (다음 세션)
1. [우선순위 높은 순서대로]
2. ...

### 마일스톤
| 마일스톤 | 상태 | 예상 완료 |
|---------|------|----------|
| [이름] | [진행중/완료/지연] | [날짜] |

---

## 📈 효율성 분석 (Admin Team)

### 이번 세션 효율성
- 작업 완료율: [X%]
- 병목 지점: [있으면 기록]

### 전략적 이슈
- [전략적으로 고려해야 할 사항]

---

## ⚠️ 품질 및 이슈 (Audit Team)

### 미해결 이슈
- [ ] [이슈 1]
- [ ] [이슈 2]

### 품질 경고
- [품질 관련 경고 사항]

### 표준 준수 현황
- [표준/규칙 위반 사항]

---

## 🏆 프로젝트 팀별 정리

### [Team 1: 팀명]
**담당 영역**: [영역]
**상태**: [진행중/완료/대기]
**이번 세션 작업**:
- [작업 내용]

**다음 세션 TODO**:
- [TODO 항목]

**이슈**:
- [이슈 있으면 기록]

### [Team 2: 팀명]
...

---

## 📎 관련 파일 (종속관계)

### 이번 세션 변경된 파일
- [파일명](경로) - 변경 내용: [설명]

### 참조해야 할 파일
- [파일명](경로) - 역할: [설명]

### 관련 로그
- [로그명](경로) - 생성시각: YYYYMMDD_HHMMSS

---

## 🔗 버전 정보

- 핸드오프 버전: YYYYMMDD_HHMMSS
- 이전 핸드오프: [파일명](경로) (있는 경우)
- 참조 파일 버전: [파일명] - YYYYMMDD_HHMMSS

---

**다음 세션 시작 시 이 문서를 읽어주세요.**
```

---

## 📋 세션 시작 커맨드 (session_resume)

### 유저커맨드 헤더

```bash
# @command: session_resume
# @purpose: 새 세션 시작 시 이전 핸드오프 로드 및 에이전트 팀 브리핑
# @usage: 새 세션 시작 시, "이어서", "계속", "어디까지 했지" 요청 시
# @keywords: 재개,이어서,계속,resume,복원,어디까지,시작,브리핑
# @triggers: "이어서", "계속 진행", "어디까지 했지", "resume", "시작", "브리핑"
# @background: false
# @dependencies: common, reentry_check, agent_teams
# @output: 이전 맥락 요약 출력, 팀별 브리핑
```

### 실행 프로세스

```
세션 시작/재개 트리거 감지:
  │
  ├─▶ 1. 재진입 검사
  │     └─ reentry_check 실행
  │     └─ Clock.json, Current_Global.md 확인
  │
  ├─▶ 2. 최신 핸드오프 문서 검색
  │     └─ !AGENT_System/에서 *_HANDOFF.MD 파일 검색
  │     └─ 가장 최근 파일 로드
  │
  ├─▶ 3. 총괄 팀 브리핑
  │     └─ 핸드오프 요약 출력
  │     └─ 다음 세션 최우선 작업 안내
  │
  ├─▶ 4. 프로젝트 팀 활성화 (있는 경우)
  │     └─ `.cursor/rules/AGENT_Teams.mdc` 확인
  │     └─ 각 팀에 자기 영역 상태 브리핑
  │
  ├─▶ 5. 상급 팀 브리핑
  │     ├─ PM 팀: TODO, 마일스톤 안내
  │     ├─ 관리자 팀: 효율성 목표 안내
  │     └─ 감사 팀: 미해결 이슈 경고
  │
  └─▶ 6. Current_Global.md 업데이트
        └─ 세션 시작 기록
```

### 브리핑 출력 형식

```markdown
# 🚀 세션 재개 브리핑

**이전 세션 종료**: YYYY-MM-DD HH:MM:SS
**현재 세션 시작**: YYYY-MM-DD HH:MM:SS

---

## 📋 총괄 요약

[핸드오프 문서의 총괄 요약 섹션]

---

## ⚡ 다음 세션 최우선 작업

1. [최우선 작업 1]
2. [최우선 작업 2]
3. ...

---

## ⚠️ 주의 사항

- [미해결 이슈]
- [품질 경고]

---

## 🏆 활성화된 에이전트 팀

### 상급 팀 (항상 활성화)
- ✅ 총괄 팀 (Chief)
- ✅ PM 팀
- ✅ 관리자 팀 (Admin)
- ✅ 감사 팀 (Audit)

### 프로젝트 팀 (`.cursor/rules/AGENT_Teams.mdc`)
- ✅ [팀명 1]
- ✅ [팀명 2]
- ...

---

**작업을 시작하시겠습니까?**
```

---

## 📋 에이전트 팀 호출 방식

### 상급 팀 호출 (유저룰스 기반)

상급 팀은 유저룰스에 정의되어 있으므로 **항상 활성화**됩니다.

```
호출 방식:
  1. 트리거 키워드 감지 ("끝내자", "이어서" 등)
  2. "@keywords: 총괄,PM,관리자,감사" 검색
  3. 해당 팀의 역할에 따라 정리/브리핑 실행
```

### 프로젝트 팀 호출 (프로젝트 룰스 기반)

프로젝트 팀은 `.cursor/rules/AGENT_Teams.mdc`에 정의되어 있으므로 **파일 존재 시만 활성화**됩니다.

```
호출 방식:
  1. `.cursor/rules/AGENT_Teams.mdc` 파일 존재 확인
  2. 파일 내용 파싱 → 팀 목록 추출
  3. 각 팀의 "담당 영역" 확인
  4. 해당 영역의 파일 변경사항 분석
  5. 팀별 정리/브리핑 실행
```

### 팀별 정리 호출 순서

```
세션 종료 시 (session_handoff):
  │
  ├─▶ 1차: 프로젝트 팀 (Bottom-up)
  │     └─ 각 팀이 자기 영역 정리
  │     └─ 결과를 상위로 전달
  │
  ├─▶ 2차: 상급 팀 (Top-down 종합)
  │     └─ PM: 진행 상황 종합
  │     └─ Admin: 효율성 분석
  │     └─ Audit: 품질 점검
  │
  └─▶ 3차: 총괄 팀 (최종 종합)
        └─ 모든 정리 내용 종합
        └─ 핸드오프 문서 생성
```

---

## 📋 트리거 매핑

### 세션 종료 트리거

| 사용자 입력 | 매핑 커맨드 | 동작 |
|------------|------------|------|
| "끝내자" | `session_handoff` | 에이전트 팀 정리 → 핸드오프 생성 |
| "마무리" | `session_handoff` | 에이전트 팀 정리 → 핸드오프 생성 |
| "오늘은 여기까지" | `session_handoff` | 에이전트 팀 정리 → 핸드오프 생성 |
| "세션 종료" | `session_handoff` | 에이전트 팀 정리 → 핸드오프 생성 |
| "핸드오프" | `session_handoff` | 에이전트 팀 정리 → 핸드오프 생성 |

### 세션 시작 트리거

| 사용자 입력 | 매핑 커맨드 | 동작 |
|------------|------------|------|
| "이어서" | `session_resume` | 핸드오프 로드 → 팀 브리핑 |
| "계속" | `session_resume` | 핸드오프 로드 → 팀 브리핑 |
| "어디까지 했지" | `session_resume` | 핸드오프 로드 → 팀 브리핑 |
| "시작" | `session_resume` | 핸드오프 로드 → 팀 브리핑 |
| "브리핑" | `session_resume` | 핸드오프 로드 → 팀 브리핑 |

### 자동 트리거 (새 세션 시작 시)

```
새 채팅 시작 감지:
  │
  ├─▶ 1. reentry_check 실행
  │     └─ Clock.json 확인 (10분 이상 경과 시 새 세션으로 판단)
  │
  ├─▶ 2. 새 세션 판단 시
  │     └─ 최신 핸드오프 존재 확인
  │     └─ 존재하면 자동으로 session_resume 트리거
  │
  └─▶ 3. 브리핑 출력 (간략 버전)
```

---

## 📋 유저룰스 통합 규칙 (추가 필요)

### 기본 모니터링 규칙에 추가

```markdown
### 8. 세션 종료/시작 감지

**조건**: 세션 종료/시작 키워드 감지

**세션 종료 트리거**:
- "끝내자", "마무리", "오늘은 여기까지", "세션 종료", "핸드오프" 등

**실행**:
1. "@keywords: 핸드오프,세션종료,handoff" 검색
2. `session_handoff` 커맨드 실행
3. 에이전트 팀별 정리 호출
4. 핸드오프 문서 생성

**세션 시작/재개 트리거**:
- "이어서", "계속", "어디까지 했지", "시작", "브리핑" 등
- 또는 reentry_check에서 새 세션 감지 시

**실행**:
1. "@keywords: 재개,이어서,resume" 검색
2. `session_resume` 커맨드 실행
3. 최신 핸드오프 문서 로드
4. 에이전트 팀 브리핑
```

---

## 📋 파일 구조

```
!AGENT_System/
  ├── YYYYMMDD_HHMMSS_HANDOFF.MD          # 핸드오프 문서
  ├── YYYYMMDD_HHMMSS_LOG_chief_*.MD      # 총괄 팀 로그
  ├── YYYYMMDD_HHMMSS_LOG_pm_*.MD         # PM 팀 로그
  ├── YYYYMMDD_HHMMSS_LOG_admin_*.MD      # 관리자 팀 로그
  ├── YYYYMMDD_HHMMSS_LOG_audit_*.MD      # 감사 팀 로그
  ├── YYYYMMDD_HHMMSS_LOG_system_*.MD     # 시스템 로그
  ├── Clock.json                           # 시간 동기화
  └── Current_Global.md                    # 전역 맥락
```

---

## 📋 핸드오프 히스토리 관리

### 보관 정책

- **최근 10개**: 최근 10개의 핸드오프 문서 유지
- **90일 이상**: `!AGENT_System/_ARCHIVE/` 폴더로 이동
- **1년 이상**: 압축 또는 삭제 (사용자 확인 후)

### 핸드오프 검색

```
최신 핸드오프 검색:
  1. !AGENT_System/ 폴더에서 *_HANDOFF.MD 파일 목록
  2. 파일명의 타임스탬프로 정렬 (최신순)
  3. 가장 최근 파일 반환
```

---

**이 문서는 세션 종료/시작 시 에이전트 팀이 프로젝트 상태를 정리하고 복원하는 가이드를 제공합니다.**

