---
description: "ì„±ëŠ¥ ìµœì í™” ìŠ¤í‚¬ - ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ê°€ì´ë“œ"
globs: ["**/*.ts", "**/*.tsx", "**/*.js", "**/*.jsx"]
alwaysApply: false
---

# Performance Optimization Skill

ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ“‹ ì„±ëŠ¥ ì¸¡ì • ì§€í‘œ

### Core Web Vitals

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                    Core Web Vitals                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     LCP     â”‚ â”‚     INP     â”‚ â”‚     CLS     â”‚           â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚           â”‚
â”‚  â”‚   < 2.5s    â”‚ â”‚   < 200ms   â”‚ â”‚   < 0.1     â”‚           â”‚
â”‚  â”‚  (Good)     â”‚ â”‚   (Good)    â”‚ â”‚   (Good)    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  LCP: Largest Contentful Paint (ë¡œë”©)                       â”‚
â”‚  INP: Interaction to Next Paint (ìƒí˜¸ì‘ìš©)                  â”‚
â”‚  CLS: Cumulative Layout Shift (ì‹œê°ì  ì•ˆì •ì„±)               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¸¡ì • ë„êµ¬

```bash
# Lighthouse
npx lighthouse https://example.com --view

# Web Vitals ë¼ì´ë¸ŒëŸ¬ë¦¬
npm install web-vitals
```

```typescript
// ì›¹ ë°”ì´íƒˆ ì¸¡ì •
import { onCLS, onINP, onLCP } from 'web-vitals';

onCLS(console.log);
onINP(console.log);
onLCP(console.log);
```

---

## ğŸ“‹ ë²ˆë“¤ ìµœì í™”

### 1. ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…

```typescript
// âŒ ëª¨ë“  ê²ƒì„ í•œ ë²ˆì— ë¡œë“œ
import HeavyComponent from './HeavyComponent';
import AdminPanel from './AdminPanel';

// âœ… ë™ì  ì„í¬íŠ¸ (React.lazy)
import { lazy, Suspense } from 'react';

const HeavyComponent = lazy(() => import('./HeavyComponent'));
const AdminPanel = lazy(() => import('./AdminPanel'));

function App() {
  return (
    <Suspense fallback={<Loading />}>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/heavy" element={<HeavyComponent />} />
        <Route path="/admin" element={<AdminPanel />} />
      </Routes>
    </Suspense>
  );
}
```

### 2. íŠ¸ë¦¬ ì‰ì´í‚¹

```typescript
// âŒ ì „ì²´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
import _ from 'lodash';
_.debounce(fn, 300);

// âœ… í•„ìš”í•œ í•¨ìˆ˜ë§Œ ì„í¬íŠ¸
import debounce from 'lodash/debounce';
debounce(fn, 300);

// âœ… ë˜ëŠ” lodash-es ì‚¬ìš©
import { debounce } from 'lodash-es';
```

### 3. ë²ˆë“¤ ë¶„ì„

```bash
# Next.js
npm run build
npx @next/bundle-analyzer

# Vite
npx vite-bundle-visualizer

# Webpack
npx webpack-bundle-analyzer stats.json
```

---

## ğŸ“‹ ì´ë¯¸ì§€ ìµœì í™”

### 1. í¬ë§· ì„ íƒ

```
AVIF > WebP > PNG/JPEG

AVIF: ìµœì‹ , ìµœê³  ì••ì¶• (ì§€ì› í™•ì¸ í•„ìš”)
WebP: ë„“ì€ ì§€ì›, ì¢‹ì€ ì••ì¶•
PNG: íˆ¬ëª… ì´ë¯¸ì§€
JPEG: ì‚¬ì§„
```

### 2. ë°˜ì‘í˜• ì´ë¯¸ì§€

```tsx
// âœ… srcsetìœ¼ë¡œ í•´ìƒë„ë³„ ì œê³µ
<img
  src="/image-800.jpg"
  srcSet="
    /image-400.jpg 400w,
    /image-800.jpg 800w,
    /image-1200.jpg 1200w
  "
  sizes="(max-width: 600px) 400px, (max-width: 1200px) 800px, 1200px"
  alt="Description"
  loading="lazy"
  decoding="async"
/>

// Next.js Image
import Image from 'next/image';

<Image
  src="/hero.jpg"
  width={1200}
  height={600}
  alt="Hero"
  priority  // LCP ì´ë¯¸ì§€
  placeholder="blur"
  blurDataURL={blurUrl}
/>
```

### 3. Lazy Loading

```tsx
// ë„¤ì´í‹°ë¸Œ ì§€ì—° ë¡œë”©
<img src="image.jpg" loading="lazy" alt="" />

// Intersection Observer í™œìš©
function LazyImage({ src, alt }: { src: string; alt: string }) {
  const [isVisible, setIsVisible] = useState(false);
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsVisible(true);
          observer.disconnect();
        }
      },
      { rootMargin: '100px' }
    );

    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, []);

  return (
    <div ref={ref}>
      {isVisible ? (
        <img src={src} alt={alt} />
      ) : (
        <div className="placeholder" />
      )}
    </div>
  );
}
```

---

## ğŸ“‹ ë Œë”ë§ ìµœì í™”

### 1. Memoization

```tsx
// React.memo - ì»´í¬ë„ŒíŠ¸ ë©”ëª¨ì´ì œì´ì…˜
const ExpensiveList = React.memo(function ExpensiveList({ items }) {
  return (
    <ul>
      {items.map(item => <ListItem key={item.id} item={item} />)}
    </ul>
  );
});

// useMemo - ê°’ ë©”ëª¨ì´ì œì´ì…˜
function Dashboard({ data }) {
  const processedData = useMemo(() => {
    return heavyCalculation(data);
  }, [data]);

  return <Chart data={processedData} />;
}

// useCallback - í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
function Parent() {
  const handleClick = useCallback((id: string) => {
    // ...
  }, []);

  return <Child onClick={handleClick} />;
}
```

### 2. ê°€ìƒí™” (Virtualization)

```tsx
// ê¸´ ëª©ë¡ ê°€ìƒí™”
import { useVirtualizer } from '@tanstack/react-virtual';

function VirtualList({ items }: { items: Item[] }) {
  const parentRef = useRef<HTMLDivElement>(null);

  const virtualizer = useVirtualizer({
    count: items.length,
    getScrollElement: () => parentRef.current,
    estimateSize: () => 50,  // ì•„ì´í…œ ë†’ì´
  });

  return (
    <div ref={parentRef} style={{ height: '400px', overflow: 'auto' }}>
      <div style={{ height: virtualizer.getTotalSize() }}>
        {virtualizer.getVirtualItems().map((virtualRow) => (
          <div
            key={virtualRow.key}
            style={{
              position: 'absolute',
              top: virtualRow.start,
              height: virtualRow.size,
            }}
          >
            {items[virtualRow.index].name}
          </div>
        ))}
      </div>
    </div>
  );
}
```

### 3. Debounce & Throttle

```typescript
// Debounce: ë§ˆì§€ë§‰ í˜¸ì¶œ í›„ ëŒ€ê¸°
function SearchInput() {
  const [query, setQuery] = useState('');
  
  const debouncedSearch = useMemo(
    () => debounce((q: string) => {
      fetchResults(q);
    }, 300),
    []
  );

  return (
    <input
      value={query}
      onChange={(e) => {
        setQuery(e.target.value);
        debouncedSearch(e.target.value);
      }}
    />
  );
}

// Throttle: ì£¼ê¸°ì  ì‹¤í–‰
useEffect(() => {
  const throttledScroll = throttle(() => {
    // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
  }, 100);

  window.addEventListener('scroll', throttledScroll);
  return () => window.removeEventListener('scroll', throttledScroll);
}, []);
```

---

## ğŸ“‹ ë„¤íŠ¸ì›Œí¬ ìµœì í™”

### 1. ìºì‹± ì „ëµ

```typescript
// React Query ìºì‹±
const { data } = useQuery({
  queryKey: ['users'],
  queryFn: fetchUsers,
  staleTime: 5 * 60 * 1000,     // 5ë¶„ê°„ fresh
  gcTime: 30 * 60 * 1000,       // 30ë¶„ê°„ ìºì‹œ ìœ ì§€
});

// SWR
const { data } = useSWR('/api/users', fetcher, {
  revalidateOnFocus: false,
  dedupingInterval: 60000,
});
```

### 2. í”„ë¦¬í˜ì¹­

```typescript
// Next.js Link prefetch
import Link from 'next/link';
<Link href="/about" prefetch>About</Link>

// React Query prefetch
const queryClient = useQueryClient();

// ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ í”„ë¦¬í˜ì¹˜
<div onMouseEnter={() => {
  queryClient.prefetchQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId),
  });
}}>
  <Link href={`/users/${userId}`}>View Profile</Link>
</div>
```

### 3. ì••ì¶•

```typescript
// Express gzip
import compression from 'compression';
app.use(compression());

// Next.js (ìë™ í™œì„±í™”)
// next.config.js
module.exports = {
  compress: true,
};
```

---

## ğŸ“‹ CSS ìµœì í™”

### 1. Critical CSS

```html
<!-- ì¤‘ìš” CSS ì¸ë¼ì¸ -->
<head>
  <style>
    /* í˜ì´ì§€ ì²« ë Œë”ë§ì— í•„ìš”í•œ CSSë§Œ */
    .hero { ... }
    .header { ... }
  </style>
  <!-- ë‚˜ë¨¸ì§€ëŠ” ë¹„ë™ê¸° ë¡œë“œ -->
  <link rel="preload" href="/styles.css" as="style" onload="this.rel='stylesheet'">
</head>
```

### 2. CSS-in-JS ìµœì í™”

```typescript
// âŒ ëŸ°íƒ€ì„ ìƒì„± (ì„±ëŠ¥ ì €í•˜)
const StyledButton = styled.button`
  background: ${props => props.primary ? 'blue' : 'white'};
`;

// âœ… ì •ì  ìŠ¤íƒ€ì¼ + className
const StyledButton = styled.button`
  background: white;
  &.primary {
    background: blue;
  }
`;

// âœ… ë˜ëŠ” Tailwind CSS (ë¹Œë“œ íƒ€ì„)
<button className={`bg-white ${primary ? 'bg-blue-500' : ''}`}>
```

### 3. ì• ë‹ˆë©”ì´ì…˜ ìµœì í™”

```css
/* âŒ ë ˆì´ì•„ì›ƒ íŠ¸ë¦¬ê±° (ëŠë¦¼) */
.animated {
  left: 0;
  transition: left 0.3s;
}
.animated:hover {
  left: 100px;
}

/* âœ… transform ì‚¬ìš© (GPU ê°€ì†) */
.animated {
  transform: translateX(0);
  transition: transform 0.3s;
  will-change: transform;
}
.animated:hover {
  transform: translateX(100px);
}
```

---

## ğŸ“‹ ì„±ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
ì¸¡ì •:
[ ] Lighthouse ì ìˆ˜ í™•ì¸?
[ ] Core Web Vitals ì¸¡ì •?
[ ] ë²ˆë“¤ í¬ê¸° ë¶„ì„?

ë²ˆë“¤:
[ ] ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…?
[ ] íŠ¸ë¦¬ ì‰ì´í‚¹?
[ ] ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± ì œê±°?

ì´ë¯¸ì§€:
[ ] ìµœì  í¬ë§· (WebP/AVIF)?
[ ] ë°˜ì‘í˜• ì´ë¯¸ì§€?
[ ] Lazy loading?

ë Œë”ë§:
[ ] ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€?
[ ] ê¸´ ëª©ë¡ ê°€ìƒí™”?
[ ] Debounce/Throttle?

ë„¤íŠ¸ì›Œí¬:
[ ] ì ì ˆí•œ ìºì‹±?
[ ] ì••ì¶• í™œì„±í™”?
[ ] í”„ë¦¬í˜ì¹­?
```

---

## ğŸ› ï¸ ì„±ëŠ¥ ë„êµ¬

```bash
# Lighthouse CI
npm install -g @lhci/cli
lhci autorun

# Bundle ë¶„ì„
npx source-map-explorer build/static/js/*.js

# React í”„ë¡œíŒŒì¼ëŸ¬
# React DevTools > Profiler íƒ­
```
